<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kendali LHU 2025</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
        }

        /* Enhanced Table Styles */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .table th {
            background-color: #f1f1f1;
            font-weight: 600;
        }

        .table th.bg-light {
            background-color: #f8f9fa !important;
        }

        .table td, .table th {
            padding: 0.5rem;
            font-size: 0.9rem;
            vertical-align: middle;
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .table-hover tbody tr:hover {
            background-color: rgba(0, 0, 0, 0.04);
        }

        .text-success {
            color: #28a745 !important;
        }

        .text-warning {
            color: #ffc107 !important;
        }

        .text-muted {
            color: #6c757d !important;
        }

        .fw-bold {
            font-weight: 600 !important;
        }

        #uploadBtn {
            font-weight: 600;
        }

        #fileInput {
            display: none;
        }

        @media (max-width: 768px) {
            .col-md-3 {
                margin-bottom: 20px;
            }
            
            header h1 {
                font-size: 1.5rem;
            }
        }

        .spinner-border {
            display: none;
            width: 3rem;
            height: 3rem;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .test-date-group {
            margin-bottom: 10px;
        }
        
        .test-date-label {
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
        }
        
        .empty-date {
            color: #999;
            font-style: italic;
        }
        
        /* Excel mapping styles */
        .excel-mapping-container {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
        }
        
        .excel-preview {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .excel-preview table {
            font-size: 0.85rem;
        }
        
        .excel-preview th, .excel-preview td {
            padding: 3px 8px;
            border: 1px solid #ddd;
        }
        
        .field-mapping select {
            width: 100%;
        }
        
        .required-field {
            color: red;
            margin-left: 3px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
       <header class="bg-primary text-white p-4 mb-4">
            <div class="row align-items-center">
                <div class="col-auto">
                    <img src="Logo.png" alt="Logo Disnakertrans" style="height: 150px;" />
                </div>
                <div class="col">
                    <h1 class="mb-1"><i class=""></i> KELUH 2025</h1>
                    <p class="mb-0">Sistem Monitoring Laporan Hasil Uji Lingkungan Kerja</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <button id="uploadBtn" class="btn btn-light">
                        <i class="fas fa-upload me-2"></i>Upload Excel
                    </button>
                    <input type="file" id="fileInput" accept=".xlsx,.xls">
                </div>
            </div>
        </header>

        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3">
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <i class="fas fa-filter me-2"></i>Filter Data
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="monthFilter" class="form-label">Bulan</label>
                            <select id="monthFilter" class="form-select">
                                <option value="">Semua Bulan</option>
                                <option value="1">Januari</option>
                                <option value="2">Februari</option>
                                <option value="3">Maret</option>
                                <option value="4">April</option>
                                <option value="5">Mei</option>
                                <option value="6">Juni</option>
                                <option value="7">Juli</option>
                                <option value="8">Agustus</option>
                                <option value="9">September</option>
                                <option value="10">Oktober</option>
                                <option value="11">November</option>
                                <option value="12">Desember</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="companyFilter" class="form-label">Perusahaan</label>
                            
<input type="text" id="companyFilter" class="form-control mb-2" placeholder="Cari nama perusahaan...">



                        </div>
                        <div class="mb-3">
                            
<div class="mb-3">
    <label for="pengujianFilter" class="form-label">Pengujian</label>
    <select id="pengujianFilter" class="form-select">
        <option value="">Semua Pengujian</option>
        <option value="Kebisingan">Kebisingan</option>
        <option value="Iklim Kerja">Iklim Kerja</option>
        <option value="Pencahayaan">Pencahayaan</option>
        <option value="Getaran">Getaran</option>
        <option value="Debu/Partikel/Serat">Debu/Partikel/Serat</option>
        <option value="PDS">PDS</option>
        <option value="Gas">Gas</option>
        <option value="Ergonomi">Ergonomi</option>
        <option value="Sanitasi">Sanitasi</option>
        <option value="KRUD">KRUD</option>
        <option value="Psikologi">Psikologi</option>
        <option value="Sinar UV">Sinar UV</option>
        <option value="Ambien">Ambien (Perhitungan)</option>
        <option value="Emisi Tidak Gerak">Emisi Tidak Gerak</option>
        <option value="Emisi Gerak">Emisi Gerak</option>
        <option value="Kesehatan">Kesehatan</option>
        <option value="Penerbitan LHU">Penerbitan LHU</option>
    </select>
</div>
<label for="yearFilter" class="form-label">Tahun</label>
                            <select id="yearFilter" class="form-select">
                                <option value="">Semua Tahun</option>
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                                <option value="2026">2026</option>
                            </select>
                        </div>
                        <button id="applyFilter" class="btn btn-primary w-100">
                            <i class="fas fa-check me-2"></i>Terapkan
                        </button>
                        <button id="resetFilter" class="btn btn-outline-secondary w-100 mt-2">
                            <i class="fas fa-undo me-2"></i>Reset Filter
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-success text-white">
                        <i class="fas fa-plus-circle me-2"></i>Tambah Data Baru
                    </div>
                    <div class="card-body">
                        <form id="addDataForm">
                            <div class="mb-3">
                                <label for="inputCompany" class="form-label">Nama Perusahaan <span class="required-field">*</span></label>
                                <input type="text" class="form-control" id="inputCompany" required>
                            </div>
                            <div class="mb-3">
                                <label for="inputDate" class="form-label">Tanggal Pengujian <span class="required-field">*</span></label>
                                <input type="date" class="form-control" id="inputDate" required>
                            </div>
                            <div class="mb-3">
                                <label for="inputAddress" class="form-label">Alamat</label>
                                <input type="text" class="form-control" id="inputAddress">
                            </div>
                            <div class="mb-3">
                                <label for="inputLHU" class="form-label">No. LHU</label>
                                <input type="text" class="form-control" id="inputLHU">
                            </div>
                            
                         
                            <!-- Add similar date inputs for other test types -->
                            
                            <button type="submit" class="btn btn-success w-100 mt-3">
                                <i class="fas fa-save me-2"></i>Simpan
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9">
                <div class="card mb-4">
                    <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                        <div>
                            <i class="fas fa-table me-2"></i>Tabel Data LHU
                        </div>
                        <div>
                            <button id="exportExcel" class="btn btn-sm btn-light">
                                <i class="fas fa-file-excel me-1"></i> Export Excel
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="dataTable" class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th rowspan="2">No</th>
                                        <th rowspan="2">Tanggal</th>
                                        <th rowspan="2">Perusahaan</th>
                                        <th rowspan="2">Alamat</th>
                                        <th rowspan="2">No. LHU</th>
                                        
                                        <!-- Kebisingan -->
                                        <th colspan="5" class="text-center bg-light">Kebisingan</th>
                                        
                                        <!-- Iklim Kerja -->
                                        <th colspan="5" class="text-center bg-light">Iklim Kerja</th>
                                        
                                        <!-- Pencahayaan -->
                                        <th colspan="5" class="text-center bg-light">Pencahayaan</th>
                                        
                                        <!-- Getaran -->
                                        <th colspan="5" class="text-center bg-light">Getaran</th>
                                        
                                        <!-- Debu/Partikel/Serat -->
                                        <th colspan="5" class="text-center bg-light">Debu/Partikel/Serat</th>
                                        
                                        <!-- PDS -->
                                        <th colspan="5" class="text-center bg-light">PDS</th>
                                        
                                        <!-- Gas -->
                                        <th colspan="5" class="text-center bg-light">Gas</th>
                                        
                                        <!-- Ergonomi -->
                                        <th colspan="5" class="text-center bg-light">Ergonomi</th>
                                        
                                        <!-- Sanitasi -->
                                        <th colspan="5" class="text-center bg-light">Sanitasi</th>
                                        
                                        <!-- KRUD -->
                                        <th colspan="5" class="text-center bg-light">KRUD</th>
                                        
                                        <!-- Psikologi -->
                                        <th colspan="5" class="text-center bg-light">Psikologi</th>
                                        
                                        <!-- Sinar UV -->
                                        <th colspan="5" class="text-center bg-light">Sinar UV</th>
                                        
                                        <!-- Ambien -->
                                        <th colspan="5" class="text-center bg-light">Ambien (Perhitungan)</th>
                                        
                                        <!-- Emisi Tidak Gerak -->
                                        <th colspan="5" class="text-center bg-light">Emisi Tidak Gerak</th>
                                        
                                        <!-- Emisi Gerak -->
                                        <th colspan="5" class="text-center bg-light">Emisi Gerak</th>
                                        
                                        <!-- Kesehatan -->
                                        <th colspan="5" class="text-center bg-light">Kesehatan</th>
                                        
                                        <!-- Penerbitan LHU -->
                                        <th colspan="5" class="text-center bg-light">Penerbitan LHU</th>
                                        
                                        <th rowspan="2">Aksi</th>
                                    </tr>
                                    <tr>
                                        <!-- Kebisingan subheaders -->
                                    
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Iklim Kerja subheaders -->
                                     
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Add similar subheaders for other test types -->
                                        
                                        <!-- Pencahayaan -->
                                       
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Getaran -->
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Debu/Partikel/Serat -->
                                   
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- PDS -->
                                      
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Gas -->
                                      
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Ergonomi -->
                                     
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Sanitasi -->
                                       
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- KRUD -->
                                       
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Psikologi -->
                                     
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Sinar UV -->
                                        
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Ambien -->
                                       
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Emisi Tidak Gerak -->
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Emisi Gerak -->
                                       
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Kesehatan -->
                                    
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                        
                                        <!-- Penerbitan LHU -->
                                        <th class="bg-light">Upload Lab</th>
                                        <th class="bg-light">Verifikasi</th>
                                        <th class="bg-light">Perbaikan</th>
                                        <th class="bg-light">Selesai Verifikasi</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody">
                                    <!-- Data will be filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header bg-warning text-dark">
                                <i class="fas fa-chart-pie me-2"></i>Statistik Per Bulan
                            </div>
                            <div class="card-body">
                                <canvas id="monthlyChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header bg-danger text-white">
                                <i class="fas fa-chart-bar me-2"></i>Top Perusahaan
                            </div>
                            <div class="card-body">
                                <canvas id="companyChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal untuk Edit Data -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Edit Data LHU</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <input type="hidden" id="editId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editCompany" class="form-label">Nama Perusahaan <span class="required-field">*</span></label>
                                    <input type="text" class="form-control" id="editCompany" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editDate" class="form-label">Tanggal Pengujian <span class="required-field">*</span></label>
                                    <input type="date" class="form-control" id="editDate" required>
                                </div>
                                <div class="mb-3">
                                    <label for="editAddress" class="form-label">Alamat</label>
                                    <input type="text" class="form-control" id="editAddress">
                                </div>
                                <div class="mb-3">
                                    <label for="editLHU" class="form-label">No. LHU</label>
                                    <input type="text" class="form-control" id="editLHU">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="test-date-group">
                                    <label for="editKebisinganDate" class="test-date-label">Tanggal Kebisingan</label>
                                    <input type="date" class="form-control form-control-sm" id="editKebisinganDate">
                                </div>
                                
                                <!-- Add similar date inputs for other test types -->
                                
                            </div>
                        </div>
                        
                        <!-- Test Type Sections -->
                        <div class="row mt-3">
                            <!-- Kebisingan -->
                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Kebisingan</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editKebisinganUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editKebisinganVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editKebisinganPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editKebisinganSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Iklim Kerja</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editIklimKerjaUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editIklimKerjaVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editIklimKerjaPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editIklimKerjaSelesaiVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Pencahayaan</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editPencahayaanUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editPencahayaanVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editPencahayaanPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editPencahayaanSelesaiVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Getaran</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editGetaranUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editGetaranVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editGetaranPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editGetaranSelesaiVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Debu/Partikel/Serat</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editDebuPartikelSeratUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editDebuPartikelSeratVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editDebuPartikelSeratPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editDebuPartikelSeratSelesaiVerifikasi">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">PDS</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editPdsUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editPdsVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editPdsPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editPdsSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Gas</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editGasUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editGasVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editGasPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editGasSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Ergonomi</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editErgonomiUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editErgonomiVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editErgonomiPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editErgonomiSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Sanitasi</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editSanitasiUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editSanitasiVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editSanitasiPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editSanitasiSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">KRUD</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editKrudUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editKrudVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editKrudPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editKrudSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Psikologi</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editPsikologiUploadLab">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editPsikologiVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editPsikologiPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                             <input type="date" class="form-control" id="editPsikologiSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Sinar UV</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editSinarUvUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editSinarUvVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editSinarUvPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editSinarUvSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Ambien(Perhitungan)</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                             <input type="date" class="form-control" id="editAmbienPerhitunganUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                             <input type="date" class="form-control" id="editAmbienPerhitunganVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editAmbienPerhitunganPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editAmbienPerhitunganSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Emisi Tidak Gerak</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editEmisiTidakGerakUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editEmisiTidakGerakVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editEmisiTidakGerakPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editEmisiTidakGerakSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Emisi Gerak</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editEmisiGerakUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editEmisiGerakVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editEmisiGerakPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editEmisiGerakSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Kesehatan</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Lab</label>
                                            <input type="date" class="form-control" id="editKesehatanUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editKesehatanVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editKesehatanPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editKesehatanSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <h5 class="mt-4 border-bottom pb-2">Penerbitan LHU</h5>
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">upload lab</label>
                                            <input type="date" class="form-control" id="editPenerbitanLhuUploadLab">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Verifikasi</label>
                                            <input type="date" class="form-control" id="editPenerbitanLhuVerifikasi">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Perbaikan</label>
                                            <input type="date" class="form-control" id="editPenerbitanLhuPerbaikan">
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Selesai Verifikasi</label>
                                            <input type="date" class="form-control" id="editPenerbitanLhuSelesaiVerifikasi">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Add similar sections for other test types -->
                            
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" id="saveEdit" class="btn btn-primary">Simpan Perubahan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="position-fixed top-50 start-50 translate-middle" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast align-items-center text-white bg-success" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body" id="toastMessage">
                Operasi berhasil dilakukan!
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

    <script>
        // Enhanced data structure with localStorage support
        let lhuData = [];

        // Load data from localStorage when page loads
        function loadDataFromStorage() {
            const savedData = localStorage.getItem('lhuData');
            if (savedData) {
                lhuData = JSON.parse(savedData);
            } else {
                // Default data if no saved data exists
                lhuData = [
                    {
                        no: 1,
                        tanggal: "2025-01-15",
                        perusahaan: "PT Contoh",
                        alamat: "Jl. Contoh No. 123",
                        noLhu: "LHU/2025/001",
                        
                        // Kebisingan
                        kebisingan: {
                            tanggal: "2025-01-10",
                            uploadLab: "2025-01-11",
                            verifikasi: "2025-01-12",
                            perbaikan: "2025-01-13",
                            selesaiVerifikasi: "2025-01-14"
                        },
                        
                        // Iklim Kerja
                        iklimKerja: {
                            tanggal: "2025-01-10",
                            uploadLab: "2025-01-11",
                            verifikasi: "2025-01-12",
                            perbaikan: "2025-01-13",
                            selesaiVerifikasi: "2025-01-14"
                        },
                        // Other test types with empty data...
                        pencahayaan: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        getaran: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        debuPartikelSerat: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        pds: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        gas: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        ergonomi: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        sanitasi: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        krud: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        psikologi: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        sinarUv: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        ambien: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        emisiTidakGerak: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        emisiGerak: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        kesehatan: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" },
                        penerbitanLhu: { tanggal: "", uploadLab: "", verifikasi: "", perbaikan: "", selesaiVerifikasi: "" }
                    }
                ];
                saveDataToStorage();
            }
        }

        // Save data to localStorage
        function saveDataToStorage() {
            localStorage.setItem('lhuData', JSON.stringify(lhuData));
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            loadDataFromStorage();
            renderTable(lhuData);
            setupEventListeners();
        });

        function renderTable(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            data.forEach(item => {
                const row = document.createElement('tr');
                
                // Basic info columns
                row.innerHTML = `
                    <td>${item.no}</td>
                    <td>${formatDate(item.tanggal)}</td>
                    <td>${item.perusahaan || '-'}</td>
                    <td>${item.alamat || '-'}</td>
                    <td>${item.noLhu || '-'}</td>
                `;
                
                // Function to create status cells with appropriate styling
                const createStatusCell = (value, isDate = false) => {
                    const cell = document.createElement('td');
                    if (value) {
                        if (isDate) {
                            cell.textContent = formatDate(value);
                        } else {
                            cell.textContent = value;
                            // Add appropriate styling based on status
                            if (value === 'Selesai' || value === 'Ya' || value === 'Sudah') {
                                cell.classList.add('text-success', 'fw-bold');
                            } else if (value === 'Perlu Perbaikan') {
                                cell.classList.add('text-warning', 'fw-bold');
                            }
                        }
                    } else {
                        cell.textContent = '-';
                        cell.classList.add('text-muted');
                    }
                    return cell;
                };
                
                // Kebisingan columns
                row.appendChild(createStatusCell(item.kebisingan?.tanggal, true));
                row.appendChild(createStatusCell(item.kebisingan?.uploadLab));
                row.appendChild(createStatusCell(item.kebisingan?.verifikasi));
                row.appendChild(createStatusCell(item.kebisingan?.perbaikan));
                row.appendChild(createStatusCell(item.kebisingan?.selesaiVerifikasi));
                
                // Iklim Kerja columns
                row.appendChild(createStatusCell(item.iklimKerja?.tanggal, true));
                row.appendChild(createStatusCell(item.iklimKerja?.uploadLab));
                row.appendChild(createStatusCell(item.iklimKerja?.verifikasi));
                row.appendChild(createStatusCell(item.iklimKerja?.perbaikan));
                row.appendChild(createStatusCell(item.iklimKerja?.selesaiVerifikasi));

                // Pencahayaan columns 
                row.appendChild(createStatusCell(item.pencahayaan?.tanggal, true));
                row.appendChild(createStatusCell(item.pencahayaan?.uploadLab));
                row.appendChild(createStatusCell(item.pencahayaan?.verifikasi));
                row.appendChild(createStatusCell(item.pencahayaan?.perbaikan));
                row.appendChild(createStatusCell(item.pencahayaan?.selesaiVerifikasi));

                // Getaran columns
                row.appendChild(createStatusCell(item.getaran?.tanggal, true));
                row.appendChild(createStatusCell(item.getaran?.uploadLab));
                row.appendChild(createStatusCell(item.getaran?.verifikasi));
                row.appendChild(createStatusCell(item.getaran?.perbaikan));
                row.appendChild(createStatusCell(item.getaran?.selesaiVerifikasi));

                // Debu/Partikel/Serat columns
                row.appendChild(createStatusCell(item.debuPartikelSerat?.tanggal, true));
                row.appendChild(createStatusCell(item.debuPartikelSerat?.uploadLab));
                row.appendChild(createStatusCell(item.debuPartikelSerat?.verifikasi));
                row.appendChild(createStatusCell(item.debuPartikelSerat?.perbaikan));
                row.appendChild(createStatusCell(item.debuPartikelSerat?.selesaiVerifikasi));

                // PDS
                row.appendChild(createStatusCell(item.pds?.tanggal, true));
                row.appendChild(createStatusCell(item.pds?.uploadLab));
                row.appendChild(createStatusCell(item.pds?.verifikasi));
                row.appendChild(createStatusCell(item.pds?.perbaikan));
                row.appendChild(createStatusCell(item.pds?.selesaiVerifikasi));

                // Gas
                row.appendChild(createStatusCell(item.gas?.tanggal, true));
                row.appendChild(createStatusCell(item.gas?.uploadLab));
                row.appendChild(createStatusCell(item.gas?.verifikasi));
                row.appendChild(createStatusCell(item.gas?.perbaikan));
                row.appendChild(createStatusCell(item.gas?.selesaiVerifikasi));

                // Ergonomi
                row.appendChild(createStatusCell(item.ergonomi?.tanggal, true));
                row.appendChild(createStatusCell(item.ergonomi?.uploadLab));
                row.appendChild(createStatusCell(item.ergonomi?.verifikasi));
                row.appendChild(createStatusCell(item.ergonomi?.perbaikan));
                row.appendChild(createStatusCell(item.ergonomi?.selesaiVerifikasi));

                // Sanitasi
                row.appendChild(createStatusCell(item.sanitasi?.tanggal, true));
                row.appendChild(createStatusCell(item.sanitasi?.uploadLab));
                row.appendChild(createStatusCell(item.sanitasi?.verifikasi));
                row.appendChild(createStatusCell(item.sanitasi?.perbaikan));
                row.appendChild(createStatusCell(item.sanitasi?.selesaiVerifikasi));

                // Krud
                row.appendChild(createStatusCell(item.krud?.tanggal, true));
                row.appendChild(createStatusCell(item.krud?.uploadLab));
                row.appendChild(createStatusCell(item.krud?.verifikasi));
                row.appendChild(createStatusCell(item.krud?.perbaikan));
                row.appendChild(createStatusCell(item.krud?.selesaiVerifikasi));

                // Psikologi
                row.appendChild(createStatusCell(item.psikologi?.tanggal, true));
                row.appendChild(createStatusCell(item.psikologi?.uploadLab));
                row.appendChild(createStatusCell(item.psikologi?.verifikasi));
                row.appendChild(createStatusCell(item.psikologi?.perbaikan));
                row.appendChild(createStatusCell(item.psikologi?.selesaiVerifikasi));

                // Sinar Uv
                row.appendChild(createStatusCell(item.sinarUv?.tanggal, true));
                row.appendChild(createStatusCell(item.sinarUv?.uploadLab));
                row.appendChild(createStatusCell(item.sinarUv?.verifikasi));
                row.appendChild(createStatusCell(item.sinarUv?.perbaikan));
                row.appendChild(createStatusCell(item.sinarUv?.selesaiVerifikasi));

                // Ambien
                row.appendChild(createStatusCell(item.ambien?.tanggal, true));
                row.appendChild(createStatusCell(item.ambien?.uploadLab));
                row.appendChild(createStatusCell(item.ambien?.verifikasi));
                row.appendChild(createStatusCell(item.ambien?.perbaikan));
                row.appendChild(createStatusCell(item.ambien?.selesaiVerifikasi));

                // Emisi Tidak Gerak
                row.appendChild(createStatusCell(item.emisiTidakGerak?.tanggal, true));
                row.appendChild(createStatusCell(item.emisiTidakGerak?.uploadLab));
                row.appendChild(createStatusCell(item.emisiTidakGerak?.verifikasi));
                row.appendChild(createStatusCell(item.emisiTidakGerak?.perbaikan));
                row.appendChild(createStatusCell(item.emisiTidakGerak?.selesaiVerifikasi));

                // Emisi Gerak
                row.appendChild(createStatusCell(item.emisiGerak?.tanggal, true));
                row.appendChild(createStatusCell(item.emisiGerak?.uploadLab));
                row.appendChild(createStatusCell(item.emisiGerak?.verifikasi));
                row.appendChild(createStatusCell(item.emisiGerak?.perbaikan));
                row.appendChild(createStatusCell(item.emisiGerak?.selesaiVerifikasi));

                // Kesehatan
                row.appendChild(createStatusCell(item.kesehatan?.tanggal, true));
                row.appendChild(createStatusCell(item.kesehatan?.uploadLab));
                row.appendChild(createStatusCell(item.kesehatan?.verifikasi));
                row.appendChild(createStatusCell(item.kesehatan?.perbaikan));
                row.appendChild(createStatusCell(item.kesehatan?.selesaiVerifikasi));

                // Penerbitan LHU
                row.appendChild(createStatusCell(item.penerbitanLhu?.tanggal, true));
                row.appendChild(createStatusCell(item.penerbitanLhu?.uploadLab));
                row.appendChild(createStatusCell(item.penerbitanLhu?.verifikasi));
                row.appendChild(createStatusCell(item.penerbitanLhu?.perbaikan));
                row.appendChild(createStatusCell(item.penerbitanLhu?.selesaiVerifikasi));
                
                // Action buttons
                const actionCell = document.createElement('td');
                actionCell.innerHTML = `
                    <button class="btn btn-sm btn-primary edit-btn" data-id="${item.no}">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-sm btn-danger delete-btn" data-id="${item.no}">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                row.appendChild(actionCell);
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editData(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteData(id);
                });
            });
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            try {
                const date = new Date(dateStr);
                if (isNaN(date.getTime())) return '';
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                return `${day}/${month}/${date.getFullYear()}`;
            } catch (e) {
                return '';
            }
        }

        function editData(id) {
            const item = lhuData.find(item => item.no === id);
            if (!item) return;
            
            // Basic info
            document.getElementById('editId').value = item.no;
            document.getElementById('editCompany').value = item.perusahaan || '';
            document.getElementById('editDate').value = item.tanggal || '';
            document.getElementById('editAddress').value = item.alamat || '';
            document.getElementById('editLHU').value = item.noLhu || '';
            
            // Kebisingan
            document.getElementById('editKebisinganDate').value = item.kebisingan?.tanggal || '';
            document.getElementById('editKebisinganUploadLab').value = item.kebisingan?.uploadLab || '';
            document.getElementById('editKebisinganVerifikasi').value = item.kebisingan?.verifikasi || '';
            document.getElementById('editKebisinganPerbaikan').value = item.kebisingan?.perbaikan || '';
            document.getElementById('editKebisinganSelesaiVerifikasi').value = item.kebisingan?.selesaiVerifikasi || '';
            
            // Iklim Kerja
            document.getElementById('editIklimKerjaUploadLab').value = item.iklimKerja?.uploadLab || '';
            document.getElementById('editIklimKerjaVerifikasi').value = item.iklimKerja?.verifikasi || '';
            document.getElementById('editIklimKerjaPerbaikan').value = item.iklimKerja?.perbaikan || '';
            document.getElementById('editIklimKerjaSelesaiVerifikasi').value = item.iklimKerja?.selesaiVerifikasi || '';

            // Pencahayaan
            document.getElementById('editPencahayaanUploadLab').value = item.pencahayaan?.uploadLab || '';
            document.getElementById('editPencahayaanVerifikasi').value = item.pencahayaan?.verifikasi || '';
            document.getElementById('editPencahayaanPerbaikan').value = item.pencahayaan?.perbaikan || '';
            document.getElementById('editPencahayaanSelesaiVerifikasi').value = item.pencahayaan?.selesaiVerifikasi || '';

            // Getaran
            document.getElementById('editGetaranUploadLab').value = item.getaran?.uploadLab || '';
            document.getElementById('editGetaranVerifikasi').value = item.getaran?.verifikasi || '';
            document.getElementById('editGetaranPerbaikan').value = item.getaran?.perbaikan || '';
            document.getElementById('editGetaranSelesaiVerifikasi').value = item.getaran?.selesaiVerifikasi || '';

            // Debu/Partikel/Serat
            document.getElementById('editDebuPartikelSeratUploadLab').value = item.debuPartikelSerat?.uploadLab || '';
            document.getElementById('editDebuPartikelSeratVerifikasi').value = item.debuPartikelSerat?.verifikasi || '';
            document.getElementById('editDebuPartikelSeratPerbaikan').value = item.debuPartikelSerat?.perbaikan || '';
            document.getElementById('editDebuPartikelSeratSelesaiVerifikasi').value = item.debuPartikelSerat?.selesaiVerifikasi || '';

            // PDS
            document.getElementById('editPdsUploadLab').value = item.pds?.uploadLab || '';
            document.getElementById('editPdsVerifikasi').value = item.pds?.verifikasi || '';
            document.getElementById('editPdsPerbaikan').value = item.pds?.perbaikan || '';
            document.getElementById('editPdsSelesaiVerifikasi').value = item.pds?.selesaiVerifikasi || '';

            // Gas
            document.getElementById('editGasUploadLab').value = item.gas?.uploadLab || '';
            document.getElementById('editGasVerifikasi').value = item.gas?.verifikasi || '';
            document.getElementById('editGasPerbaikan').value = item.gas?.perbaikan || '';
            document.getElementById('editGasSelesaiVerifikasi').value = item.gas?.selesaiVerifikasi || '';

            // Ergonomi
            document.getElementById('editErgonomiUploadLab').value = item.ergonomi?.uploadLab || '';
            document.getElementById('editErgonomiVerifikasi').value = item.ergonomi?.verifikasi || '';
            document.getElementById('editErgonomiPerbaikan').value = item.ergonomi?.perbaikan || '';
            document.getElementById('editErgonomiSelesaiVerifikasi').value = item.ergonomi?.selesaiVerifikasi || '';

            // Sanitasi
            document.getElementById('editSanitasiUploadLab').value = item.sanitasi?.uploadLab || '';
            document.getElementById('editSanitasiVerifikasi').value = item.sanitasi?.verifikasi || '';
            document.getElementById('editSanitasiPerbaikan').value = item.sanitasi?.perbaikan || '';
            document.getElementById('editSanitasiSelesaiVerifikasi').value = item.sanitasi?.selesaiVerifikasi || '';

            // KRUD
            document.getElementById('editKrudUploadLab').value = item.krud?.uploadLab || '';
            document.getElementById('editKrudVerifikasi').value = item.krud?.verifikasi || '';
            document.getElementById('editKrudPerbaikan').value = item.krud?.perbaikan || '';
            document.getElementById('editKrudSelesaiVerifikasi').value = item.krud?.selesaiVerifikasi || '';

            // Psikologi
            document.getElementById('editPsikologiUploadLab').value = item.psikologi?.uploadLab || '';
            document.getElementById('editPsikologiVerifikasi').value = item.psikologi?.verifikasi || '';
            document.getElementById('editPsikologiPerbaikan').value = item.psikologi?.perbaikan || '';
            document.getElementById('editPsikologiSelesaiVerifikasi').value = item.psikologi?.selesaiVerifikasi || '';

            // Sinar UV
            document.getElementById('editSinarUvUploadLab').value = item.sinarUv?.uploadLab || '';
            document.getElementById('editSinarUvVerifikasi').value = item.sinarUv?.verifikasi || '';
            document.getElementById('editSinarUvPerbaikan').value = item.sinarUv?.perbaikan || '';
            document.getElementById('editSinarUvSelesaiVerifikasi').value = item.sinarUv?.selesaiVerifikasi || '';

            // Ambien
            document.getElementById('editAmbienPerhitunganUploadLab').value = item.ambien?.uploadLab || '';
            document.getElementById('editAmbienPerhitunganVerifikasi').value = item.ambien?.verifikasi || '';
            document.getElementById('editAmbienPerhitunganPerbaikan').value = item.ambien?.perbaikan || '';
            document.getElementById('editAmbienPerhitunganSelesaiVerifikasi').value = item.ambien?.selesaiVerifikasi || '';

            // Emisi Tidak Gerak
            document.getElementById('editEmisiTidakGerakUploadLab').value = item.emisiTidakGerak?.uploadLab || '';
            document.getElementById('editEmisiTidakGerakVerifikasi').value = item.emisiTidakGerak?.verifikasi || '';
            document.getElementById('editEmisiTidakGerakPerbaikan').value = item.emisiTidakGerak?.perbaikan || '';
            document.getElementById('editEmisiTidakGerakSelesaiVerifikasi').value = item.emisiTidakGerak?.selesaiVerifikasi || '';

            // Emisi Gerak
            document.getElementById('editEmisiGerakUploadLab').value = item.emisiGerak?.uploadLab || '';
            document.getElementById('editEmisiGerakVerifikasi').value = item.emisiGerak?.verifikasi || '';
            document.getElementById('editEmisiGerakPerbaikan').value = item.emisiGerak?.perbaikan || '';
            document.getElementById('editEmisiGerakSelesaiVerifikasi').value = item.emisiGerak?.selesaiVerifikasi || '';

            // Kesehatan
            document.getElementById('editKesehatanUploadLab').value = item.kesehatan?.uploadLab || '';
            document.getElementById('editKesehatanVerifikasi').value = item.kesehatan?.verifikasi || '';
            document.getElementById('editKesehatanPerbaikan').value = item.kesehatan?.perbaikan || '';
            document.getElementById('editKesehatanSelesaiVerifikasi').value = item.kesehatan?.selesaiVerifikasi || '';

            // Penerbitan LHU
            document.getElementById('editPenerbitanLhuUploadLab').value = item.penerbitanLhu?.uploadLab || '';
            document.getElementById('editPenerbitanLhuVerifikasi').value = item.penerbitanLhu?.verifikasi || '';
            document.getElementById('editPenerbitanLhuPerbaikan').value = item.penerbitanLhu?.perbaikan || '';
            document.getElementById('editPenerbitanLhuSelesaiVerifikasi').value = item.penerbitanLhu?.selesaiVerifikasi || '';
            
            // Initialize modal and show
            const editModal = new bootstrap.Modal(document.getElementById('editModal'));
            editModal.show();
        }

        function saveEditedData() {
            const id = parseInt(document.getElementById('editId').value);
            const index = lhuData.findIndex(item => item.no === id);
            
            if (index === -1) return;
            
            lhuData[index] = {
                no: id,
                tanggal: document.getElementById('editDate').value,
                perusahaan: document.getElementById('editCompany').value,
                alamat: document.getElementById('editAddress').value,
                noLhu: document.getElementById('editLHU').value,
                
                // Kebisingan
                kebisingan: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editKebisinganUploadLab').value || '',
                    verifikasi: document.getElementById('editKebisinganVerifikasi').value || '',
                    perbaikan: document.getElementById('editKebisinganPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editKebisinganSelesaiVerifikasi').value || ''
                },
                
                // Iklim Kerja
                iklimKerja: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editIklimKerjaUploadLab').value || '',
                    verifikasi: document.getElementById('editIklimKerjaVerifikasi').value || '',
                    perbaikan: document.getElementById('editIklimKerjaPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editIklimKerjaSelesaiVerifikasi').value || ''
                },

                // Pencahayaan
                pencahayaan: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editPencahayaanUploadLab').value || '',
                    verifikasi: document.getElementById('editPencahayaanVerifikasi').value || '',
                    perbaikan: document.getElementById('editPencahayaanPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editPencahayaanSelesaiVerifikasi').value || ''
                },

                // Getaran
                getaran: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editGetaranUploadLab').value || '',
                    verifikasi: document.getElementById('editGetaranVerifikasi').value || '',
                    perbaikan: document.getElementById('editGetaranPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editGetaranSelesaiVerifikasi').value || ''
                },
                
                // Debu/Partikel/Serat 
                debuPartikelSerat: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editDebuPartikelSeratUploadLab').value || '',
                    verifikasi: document.getElementById('editDebuPartikelSeratVerifikasi').value || '',
                    perbaikan: document.getElementById('editDebuPartikelSeratPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editDebuPartikelSeratSelesaiVerifikasi').value || ''
                },

                // PDS
                pds: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editPdsUploadLab').value || '',
                    verifikasi: document.getElementById('editPdsVerifikasi').value || '',
                    perbaikan: document.getElementById('editPdsPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editPdsSelesaiVerifikasi').value || ''
                },

                // Gas
                gas: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editGasUploadLab').value || '',
                    verifikasi: document.getElementById('editGasVerifikasi').value || '',
                    perbaikan: document.getElementById('editGasPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editGasSelesaiVerifikasi').value || ''
                },

                // Ergonomi
                ergonomi: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editErgonomiUploadLab').value || '',
                    verifikasi: document.getElementById('editErgonomiVerifikasi').value || '',
                    perbaikan: document.getElementById('editErgonomiPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editErgonomiSelesaiVerifikasi').value || ''
                },

                // Sanitasi
                sanitasi: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editSanitasiUploadLab').value || '',
                    verifikasi: document.getElementById('editSanitasiVerifikasi').value || '',
                    perbaikan: document.getElementById('editSanitasiPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editSanitasiSelesaiVerifikasi').value || ''
                },

                // KRUD
                krud: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editKrudUploadLab').value || '',
                    verifikasi: document.getElementById('editKrudVerifikasi').value || '',
                    perbaikan: document.getElementById('editKrudPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editKrudSelesaiVerifikasi').value || ''
                },

                // Psikologi
                psikologi: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editPsikologiUploadLab').value || '',
                    verifikasi: document.getElementById('editPsikologiVerifikasi').value || '',
                    perbaikan: document.getElementById('editPsikologiPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editPsikologiSelesaiVerifikasi').value || ''
                },

                // Sinar UV
                sinarUv: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editSinarUvUploadLab').value || '',
                    verifikasi: document.getElementById('editSinarUvVerifikasi').value || '',
                    perbaikan: document.getElementById('editSinarUvPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editSinarUvSelesaiVerifikasi').value || ''
                },

                // Ambien
                ambien: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editAmbienPerhitunganUploadLab').value || '',
                    verifikasi: document.getElementById('editAmbienPerhitunganVerifikasi').value || '',
                    perbaikan: document.getElementById('editAmbienPerhitunganPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editAmbienPerhitunganSelesaiVerifikasi').value || ''
                },

                // Emisi Tidak Gerak
                emisiTidakGerak: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editEmisiTidakGerakUploadLab').value || '',
                    verifikasi: document.getElementById('editEmisiTidakGerakVerifikasi').value || '',
                    perbaikan: document.getElementById('editEmisiTidakGerakPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editEmisiTidakGerakSelesaiVerifikasi').value || ''
                },

                // Emisi Gerak
                emisiGerak: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editEmisiGerakUploadLab').value || '',
                    verifikasi: document.getElementById('editEmisiGerakVerifikasi').value || '',
                    perbaikan: document.getElementById('editEmisiGerakPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editEmisiGerakSelesaiVerifikasi').value || ''
                },

                // Kesehatan
                kesehatan: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editKesehatanUploadLab').value || '',
                    verifikasi: document.getElementById('editKesehatanVerifikasi').value || '',
                    perbaikan: document.getElementById('editKesehatanPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editKesehatanSelesaiVerifikasi').value || ''
                },

                // Penerbitan LHU
                penerbitanLhu: {
                    tanggal: document.getElementById('editKebisinganDate').value || '',
                    uploadLab: document.getElementById('editPenerbitanLhuUploadLab').value || '',
                    verifikasi: document.getElementById('editPenerbitanLhuVerifikasi').value || '',
                    perbaikan: document.getElementById('editPenerbitanLhuPerbaikan').value || '',
                    selesaiVerifikasi: document.getElementById('editPenerbitanLhuSelesaiVerifikasi').value || ''
                }
            };
            
            saveDataToStorage();
            renderTable(lhuData);
            const editModal = bootstrap.Modal.getInstance(document.getElementById('editModal'));
            editModal.hide();
            
            showToast('Data berhasil diperbarui');
        }

        function deleteData(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                lhuData = lhuData.filter(item => item.no !== id);
                saveDataToStorage();
                renderTable(lhuData);
                showToast('Data berhasil dihapus');
            }
        }

        function setupEventListeners() {
            // Upload file button
            document.getElementById('uploadBtn').addEventListener('click', function() {
                document.getElementById('fileInput').click();
            });
            
            // File input change
            document.getElementById('fileInput').addEventListener('change', handleFileUpload);
            
            // Save edit button
            document.getElementById('saveEdit').addEventListener('click', saveEditedData);
            
            // Filter buttons
            document.getElementById('applyFilter').addEventListener('click', applyFilters);
            document.getElementById('resetFilter').addEventListener('click', resetFilters);
            
            // Add new data form
            document.getElementById('addDataForm').addEventListener('submit', addNewData);
            
            // Export Excel
            document.getElementById('exportExcel').addEventListener('click', exportToExcel);
        }

        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Process Excel file here
            showToast('File berhasil diupload', 'success');
            e.target.value = ''; // Reset input
        }

        function applyFilters() {
            // Implement filter logic here
            showToast('Filter diterapkan', 'success');
        }

        function resetFilters() {
            document.getElementById('monthFilter').value = '';
            document.getElementById('companyFilter').value = '';
            document.getElementById('yearFilter').value = '';
            showToast('Filter direset', 'success');
        }

        function addNewData(e) {
            e.preventDefault();
            
            const newItem = {
                no: lhuData.length > 0 ? Math.max(...lhuData.map(item => item.no)) + 1 : 1,
                perusahaan: document.getElementById('inputCompany').value,
                tanggal: document.getElementById('inputDate').value,
                alamat: document.getElementById('inputAddress').value,
                noLhu: document.getElementById('inputLHU').value,
                
                // Initialize empty values for all test types
                kebisingan: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                iklimKerja: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                pencahayaan: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                getaran: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                debuPartikelSerat: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                pds: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                gas: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                ergonomi: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                sanitasi: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                krud: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                psikologi: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                sinarUv: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                ambien: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                emisiTidakGerak: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                emisiGerak: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                kesehatan: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' },
                penerbitanLhu: { tanggal: '', uploadLab: '', verifikasi: '', perbaikan: '', selesaiVerifikasi: '' }
            };
            
            lhuData.push(newItem);
            saveDataToStorage();
            document.getElementById('addDataForm').reset();
            renderTable(lhuData);
            showToast('Data baru berhasil ditambahkan');
        }

        function exportToExcel() {
            // Implement Excel export logic here
            showToast('Data berhasil diekspor ke Excel', 'success');
        }

        function showToast(message, type = 'success') {
            const toastEl = document.querySelector('.toast');
            const toastBody = document.getElementById('toastMessage');
            
            toastBody.textContent = message;
            toastEl.classList.remove('bg-success', 'bg-danger', 'bg-warning');
            
            if (type === 'danger') {
                toastEl.classList.add('bg-danger');
            } else if (type === 'warning') {
                toastEl.classList.add('bg-warning');
            } else {
                toastEl.classList.add('bg-success');
            }
            
            const toast = new bootstrap.Toast(toastEl);
            toast.show();
        }
    </script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('companySearchInput');
    const dropdown = document.getElementById('companyFilter');

    searchInput.addEventListener('input', function () {
        const search = this.value.toLowerCase();
        for (let option of dropdown.options) {
            const isVisible = option.value.toLowerCase().includes(search) || option.value === "";
            option.style.display = isVisible ? "block" : "none";
        }
    });
});
</script>


<script>
document.addEventListener('DOMContentLoaded', function () {
  const searchInput = document.getElementById('companySearchInput');
  const dropdown = document.getElementById('companyFilter');

  searchInput.addEventListener('input', function () {
    const search = this.value.toLowerCase();
    for (let option of dropdown.options) {
      const isVisible = option.value.toLowerCase().includes(search) || option.value === "";
      option.style.display = isVisible ? "block" : "none";
    }
  });
});
</script>

</body>
</html
    const selectedPengujian = document.getElementById('pengujianFilter').value;

    const filteredData = lhuData.filter(item => {
        const matchPengujian = !selectedPengujian || (() => {
            const key = selectedPengujian.replace(/\s|\(|\)|\//g, '').toLowerCase();
            const obj = item[key];
            return obj && (obj.uploadLab || obj.verifikasi || obj.perbaikan || obj.selesaiVerifikasi);
        })();
        return matchPengujian;
    });

    >